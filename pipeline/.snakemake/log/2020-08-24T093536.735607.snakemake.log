Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cluster nodes: 12
Job counts:
	count	jobs
	1	annotANNOVAR
	1	annotINTERVAR
	3	bgzip
	1	extractGNOMAD
	1	extractGNOMADVEP
	1	filtration_freq_and_genes
	1	gunzipCADD
	1	merge_fields
	1	scoreCADD
	3	tabix
	1	target
	15

[Mon Aug 24 09:35:37 2020]
rule bgzip:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz
    jobid: 87
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep

bgzip -f VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf
Submitted job 87 with external jobid 'Your job 4091493 ("snakejob.bgzip.87.sh") has been submitted'.
[Mon Aug 24 09:35:47 2020]
Finished job 87.
1 of 15 steps (7%) done

[Mon Aug 24 09:35:47 2020]
rule tabix:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz.tbi
    jobid: 88
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz.tbi; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz

tabix -f -p vcf VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz
Submitted job 88 with external jobid 'Your job 4091494 ("snakejob.tabix.88.sh") has been submitted'.
[Mon Aug 24 09:35:57 2020]
Finished job 88.
2 of 15 steps (13%) done

[Mon Aug 24 09:35:57 2020]
rule filtration_freq_and_genes:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz, VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz.tbi
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf
    jobid: 75
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz, VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz.tbi

filter_vep.pl 			-i VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz 			-o VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf 			-filter '(Gene in ENSG00000205403,ENSG00000000971,ENSG00000117335,ENSG00000134389,ENSG00000243649) and (gnomad.AF_NFE < 0.45 or not gnomad.AF_NFE)'
Submitted job 75 with external jobid 'Your job 4091495 ("snakejob.filtration_freq_and_genes.75.sh") has been submitted'.
Write-protecting output file VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.
[Mon Aug 24 09:36:18 2020]
Finished job 75.
3 of 15 steps (20%) done

[Mon Aug 24 09:36:18 2020]
rule bgzip:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
    jobid: 59
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered

bgzip -f VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf
Submitted job 59 with external jobid 'Your job 4091496 ("snakejob.bgzip.59.sh") has been submitted'.
[Mon Aug 24 09:36:28 2020]
Finished job 59.
4 of 15 steps (27%) done

[Mon Aug 24 09:36:28 2020]
rule tabix:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz.tbi
    jobid: 60
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz.tbi; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz

tabix -f -p vcf VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
Submitted job 60 with external jobid 'Your job 4091497 ("snakejob.tabix.60.sh") has been submitted'.

[Mon Aug 24 09:36:28 2020]
rule extractGNOMAD:
    input: /sandbox/users/mguillout/pipeline/REFERENCES/human_g1k_v37.fasta, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
    output: CSV/gnomad_freq.tsv
    jobid: 61
    reason: Missing output files: CSV/gnomad_freq.tsv; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz

gatk -T VariantsToTable 		-R /sandbox/users/mguillout/pipeline/REFERENCES/human_g1k_v37.fasta 		-V VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz 		-o CSV/gnomad_freq.tsv 		-F CHROM 		-F POS 		-F REF 		-F ALT 		-F ID 		-GF GT 		--allowMissingData 		-F gnomad.AF_AFR 		-F gnomad.AF_ASJ 		-F gnomad.AF_AMR 		-F gnomad.AF_EAS 		-F gnomad.AF_FIN 		-F gnomad.AF_NFE 		-F gnomad.AF_OTH 		-F gnomad.AF_SAS 
Submitted job 61 with external jobid 'Your job 4091498 ("snakejob.extractGNOMAD.61.sh") has been submitted'.

[Mon Aug 24 09:36:28 2020]
rule scoreCADD:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz, /sandbox/users/mguillout/tools/CADD-scripts/CADD.sh
    output: CSV/cadd.tsv.gz
    jobid: 62
    reason: Missing output files: CSV/cadd.tsv.gz; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz

 /sandbox/users/mguillout/tools/CADD-scripts/CADD.sh 		-o CSV/cadd.tsv.gz 		-a 		-g GRCh37 		-v v1.6 VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
Submitted job 62 with external jobid 'Your job 4091499 ("snakejob.scoreCADD.62.sh") has been submitted'.
[Mon Aug 24 09:36:48 2020]
Finished job 60.
5 of 15 steps (33%) done

[Mon Aug 24 09:36:48 2020]
rule annotANNOVAR:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz.tbi, /sandbox/users/mguillout/tools/annovar, /sandbox/users/mguillout/tools/annovar/humandb
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.avinput, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.txt
    jobid: 34
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.txt, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.avinput; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz.tbi

perl /sandbox/users/mguillout/tools/annovar/table_annovar.pl VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz  		/sandbox/users/mguillout/tools/annovar/humandb		-buildver hg19 		-out VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf 		-remove 		-protocol refGene,knownGene,dgvMerged,gwasCatalog,dbnsfp35a,clinvar_20190305 		-operation gx,g,r,r,f,f 		-nastring . 		-polish 		-otherinfo 		-xref /sandbox/users/mguillout/tools/annovar/humandb/hg19_refGene.txt 		-vcfinput
Submitted job 34 with external jobid 'Your job 4091500 ("snakejob.annotANNOVAR.34.sh") has been submitted'.
Write-protecting output file CSV/gnomad_freq.tsv.
[Mon Aug 24 09:36:58 2020]
Finished job 61.
6 of 15 steps (40%) done

[Mon Aug 24 09:36:58 2020]
rule extractGNOMADVEP:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz, CSV/gnomad_freq.tsv
    output: CSV/gnomad_vep.tsv
    jobid: 36
    reason: Missing output files: CSV/gnomad_vep.tsv; Input files updated by another job: CSV/gnomad_freq.tsv, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz

vep-annotation-reporter  VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz 	Feature HGVSc HGVSp Protein_position Amino_acids Codons CLIN_SIG PUBMED 		-t CSV/gnomad_freq.tsv 		-o CSV/gnomad_vep.tsv 		
Submitted job 36 with external jobid 'Your job 4091501 ("snakejob.extractGNOMADVEP.36.sh") has been submitted'.
[Mon Aug 24 09:37:18 2020]
Finished job 36.
7 of 15 steps (47%) done
Write-protecting output file VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.
[Mon Aug 24 09:37:28 2020]
Finished job 34.
8 of 15 steps (53%) done

[Mon Aug 24 09:37:28 2020]
rule bgzip:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz
    jobid: 1
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno

bgzip -f VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf
Submitted job 1 with external jobid 'Your job 4091502 ("snakejob.bgzip.1.sh") has been submitted'.

[Mon Aug 24 09:37:28 2020]
rule annotINTERVAR:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.avinput, /sandbox/users/mguillout/tools/annovar, /sandbox/users/mguillout/tools/annovar/humandb, /sandbox/users/mguillout/tools/InterVar-master
    output: CSV/res_intervar.hg19_multianno.txt.intervar
    jobid: 35
    reason: Missing output files: CSV/res_intervar.hg19_multianno.txt.intervar; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.avinput

python /sandbox/users/mguillout/tools/InterVar-master/Intervar.py 		-i VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.avinput 		-o CSV/res_intervar 		--buildver hg19 		--input_type AVinput 		--database_intervar /sandbox/users/mguillout/tools/InterVar-master/intervardb 		--config=/sandbox/users/mguillout/tools/InterVar-master/config.ini 		--convert2annovar /sandbox/users/mguillout/tools/annovar/convert2annovar.pl 		--table_annovar /sandbox/users/mguillout/tools/annovar/table_annovar.pl 		--annotate_variation /sandbox/users/mguillout/tools/annovar/annotate_variation.pl 		--database_locat /sandbox/users/mguillout/tools/annovar/humandb
Submitted job 35 with external jobid 'Your job 4091503 ("snakejob.annotINTERVAR.35.sh") has been submitted'.
[Mon Aug 24 09:37:48 2020]
Finished job 1.
9 of 15 steps (60%) done

[Mon Aug 24 09:37:48 2020]
rule tabix:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz.tbi
    jobid: 2
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz.tbi; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz

tabix -f -p vcf VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz
Submitted job 2 with external jobid 'Your job 4091504 ("snakejob.tabix.2.sh") has been submitted'.
[Mon Aug 24 09:37:58 2020]
Finished job 2.
10 of 15 steps (67%) done
[Mon Aug 24 09:38:28 2020]
Finished job 62.
11 of 15 steps (73%) done

[Mon Aug 24 09:38:28 2020]
rule gunzipCADD:
    input: CSV/cadd.tsv.gz
    output: CSV/cadd.tsv
    jobid: 37
    reason: Missing output files: CSV/cadd.tsv; Input files updated by another job: CSV/cadd.tsv.gz

gunzip CSV/cadd.tsv.gz ;  sed 1d CSV/cadd.tsv -i
Submitted job 37 with external jobid 'Your job 4091505 ("snakejob.gunzipCADD.37.sh") has been submitted'.
[Mon Aug 24 09:38:48 2020]
Finished job 37.
12 of 15 steps (80%) done
[Mon Aug 24 09:51:29 2020]
Finished job 35.
13 of 15 steps (87%) done

[Mon Aug 24 09:51:29 2020]
rule merge_fields:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.txt, CSV/res_intervar.hg19_multianno.txt.intervar, CSV/gnomad_vep.tsv, CSV/cadd.tsv
    output: CSV/main_results.tsv
    jobid: 3
    reason: Missing output files: CSV/main_results.tsv; Input files updated by another job: CSV/res_intervar.hg19_multianno.txt.intervar, CSV/gnomad_vep.tsv, CSV/cadd.tsv, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.txt

Submitted job 3 with external jobid 'Your job 4091506 ("snakejob.merge_fields.3.sh") has been submitted'.
[Mon Aug 24 09:51:49 2020]
Error in rule merge_fields:
    jobid: 3
    output: CSV/main_results.tsv
    cluster_jobid: Your job 4091506 ("snakejob.merge_fields.3.sh") has been submitted

Error executing rule merge_fields on cluster (jobid: 3, external: Your job 4091506 ("snakejob.merge_fields.3.sh") has been submitted, jobscript: /sandbox/shares/nextcloud/mguillout/files/Application/pipeline/APHP/.snakemake/tmp._1k6q6pj/snakejob.merge_fields.3.sh). For error details see the cluster log and the log files of the involved rule(s).
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /sandbox/shares/nextcloud/mguillout/files/Application/pipeline/.snakemake/log/2020-08-24T093536.735607.snakemake.log
