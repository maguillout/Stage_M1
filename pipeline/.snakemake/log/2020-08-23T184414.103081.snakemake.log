Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cluster nodes: 12
Job counts:
	count	jobs
	1	annotANNOVAR
	1	annotINTERVAR
	1	annotVEP
	3	bgzip
	1	extractGNOMAD
	1	extractGNOMADVEP
	1	filtration_freq_and_genes
	1	freqGNOMAD
	1	gunzipCADD
	1	merge_fields
	1	scoreCADD
	3	tabix
	1	target
	17

[Sun Aug 23 18:44:15 2020]
rule freqGNOMAD:
    input: /sandbox/users/mguillout/pipeline/REFERENCES/human_g1k_v37.fasta, VCF/hapcaller.recal.combined.vcf.gz, VCF/hapcaller.recal.combined.vcf.gz.tbi, /sandbox/users/mguillout/pipeline/REFERENCES/gnomad.exomes.r2.0.1.sites.vcf.gz, /sandbox/users/mguillout/pipeline/REFERENCES/dbsnp_138.b37.vcf.gz, /sandbox/users/mguillout/pipeline/REFERENCES/human_g1k_v37.dict, gatkPresent.txt
    output: VCF/hapcaller.recal.combined.annot.gnomad.vcf.gz, VCF/hapcaller.recal.combined.annot.gnomad.vcf.gz.tbi
    jobid: 40
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vcf.gz; Updated input files: VCF/hapcaller.recal.combined.vcf.gz.tbi, gatkPresent.txt, VCF/hapcaller.recal.combined.vcf.gz

gatk -Djava.io.tmpdir=VCF		-XX:ParallelGCThreads=3 		-Xmx3g 		-T VariantAnnotator 		-R /sandbox/users/mguillout/pipeline/REFERENCES/human_g1k_v37.fasta 		--variant VCF/hapcaller.recal.combined.vcf.gz 		-L VCF/hapcaller.recal.combined.vcf.gz 		--resource:gnomad /sandbox/users/mguillout/pipeline/REFERENCES/gnomad.exomes.r2.0.1.sites.vcf.gz 		--resourceAlleleConcordance 		-E gnomad.AF_AFR 		-E gnomad.AF_ASJ 		-E gnomad.AF_AMR 		-E gnomad.AF_EAS 		-E gnomad.AF_FIN 		-E gnomad.AF_NFE 		-E gnomad.AF_OTH 		-E gnomad.AF_SAS 		--dbsnp /sandbox/users/mguillout/pipeline/REFERENCES/dbsnp_138.b37.vcf.gz 		-o VCF/hapcaller.recal.combined.annot.gnomad.vcf.gz
Submitted job 40 with external jobid 'Your job 4090702 ("snakejob.freqGNOMAD.40.sh") has been submitted'.
Removing temporary output file VCF/hapcaller.recal.combined.vcf.gz.tbi.
Removing temporary output file VCF/hapcaller.recal.combined.vcf.gz.
Removing temporary output file gatkPresent.txt.
[Sun Aug 23 18:45:15 2020]
Finished job 40.
1 of 17 steps (6%) done

[Sun Aug 23 18:45:15 2020]
rule annotVEP:
    input: /sandbox/users/mguillout/pipeline/REFERENCES/human_g1k_v37.fasta, VCF/hapcaller.recal.combined.annot.gnomad.vcf.gz, VCF/hapcaller.recal.combined.annot.gnomad.vcf.gz.tbi, /sandbox/users/mguillout/pipeline/REFERENCES/VEP/CACHE/homo_sapiens_merged_86_GRCh37_cache.done
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf
    jobid: 38
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vcf.gz.tbi, VCF/hapcaller.recal.combined.annot.gnomad.vcf.gz

variant_effect_predictor.pl 		--pick_order=canonical 		--cache --dir /sandbox/users/mguillout/pipeline/REFERENCES/VEP/CACHE 		--dir_plugins /sandbox/users/mguillout/tools/VEP_plugins 		--species homo_sapiens_merged 		--assembly GRCh37 		--db_version 86 		--fasta /sandbox/users/mguillout/pipeline/REFERENCES/human_g1k_v37.fasta 		--offline 		--symbol 		--format vcf 		--force_overwrite 		--sift=b 		--polyphen=b 		--xref_refseq 		-i VCF/hapcaller.recal.combined.annot.gnomad.vcf.gz 		-o VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf 		--quiet 		--vcf 		--gmaf 		--ccds 		--canonical 		--maf_1kg 		--pubmed 		--hgvs 		--no_stats
Submitted job 38 with external jobid 'Your job 4090703 ("snakejob.annotVEP.38.sh") has been submitted'.
Write-protecting output file VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.
[Sun Aug 23 18:56:16 2020]
Finished job 38.
2 of 17 steps (12%) done

[Sun Aug 23 18:56:16 2020]
rule bgzip:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz
    jobid: 35
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep

bgzip -f VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf
Submitted job 35 with external jobid 'Your job 4090704 ("snakejob.bgzip.35.sh") has been submitted'.
[Sun Aug 23 18:56:36 2020]
Finished job 35.
3 of 17 steps (18%) done

[Sun Aug 23 18:56:36 2020]
rule tabix:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz.tbi
    jobid: 36
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz.tbi; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz

tabix -f -p vcf VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz
Submitted job 36 with external jobid 'Your job 4090705 ("snakejob.tabix.36.sh") has been submitted'.
[Sun Aug 23 18:56:46 2020]
Finished job 36.
4 of 17 steps (24%) done

[Sun Aug 23 18:56:46 2020]
rule filtration_freq_and_genes:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz, VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz.tbi
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf
    jobid: 31
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz.tbi, VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz

filter_vep.pl 			-i VCF/hapcaller.recal.combined.annot.gnomad.vep.vcf.gz 			-o VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf 			-filter '(Gene in ENSG00000205403,ENSG00000000971,ENSG00000117335,ENSG00000134389,ENSG00000243649) and (gnomad.AF_NFE < 0.45 or not gnomad.AF_NFE)'
Submitted job 31 with external jobid 'Your job 4090706 ("snakejob.filtration_freq_and_genes.31.sh") has been submitted'.
Write-protecting output file VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.
[Sun Aug 23 18:57:06 2020]
Finished job 31.
5 of 17 steps (29%) done

[Sun Aug 23 18:57:06 2020]
rule bgzip:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
    jobid: 23
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered

bgzip -f VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf
Submitted job 23 with external jobid 'Your job 4090707 ("snakejob.bgzip.23.sh") has been submitted'.
[Sun Aug 23 18:57:16 2020]
Finished job 23.
6 of 17 steps (35%) done

[Sun Aug 23 18:57:16 2020]
rule extractGNOMAD:
    input: /sandbox/users/mguillout/pipeline/REFERENCES/human_g1k_v37.fasta, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
    output: CSV/gnomad_freq.tsv
    jobid: 25
    reason: Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz

gatk -T VariantsToTable 		-R /sandbox/users/mguillout/pipeline/REFERENCES/human_g1k_v37.fasta 		-V VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz 		-o CSV/gnomad_freq.tsv 		-F CHROM 		-F POS 		-F REF 		-F ALT 		-F END 		-F ID 		-F DP 		--allowMissingData 		-F gnomad.AF_AFR 		-F gnomad.AF_ASJ 		-F gnomad.AF_AMR 		-F gnomad.AF_EAS 		-F gnomad.AF_FIN 		-F gnomad.AF_NFE 		-F gnomad.AF_OTH 		-F gnomad.AF_SAS 
Submitted job 25 with external jobid 'Your job 4090708 ("snakejob.extractGNOMAD.25.sh") has been submitted'.

[Sun Aug 23 18:57:16 2020]
rule tabix:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz.tbi
    jobid: 24
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz.tbi; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz

tabix -f -p vcf VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
Submitted job 24 with external jobid 'Your job 4090709 ("snakejob.tabix.24.sh") has been submitted'.

[Sun Aug 23 18:57:16 2020]
rule scoreCADD:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz, /sandbox/users/mguillout/tools/CADD-scripts/CADD.sh
    output: CSV/cadd.tsv.gz
    jobid: 26
    reason: Missing output files: CSV/cadd.tsv.gz; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz

 /sandbox/users/mguillout/tools/CADD-scripts/CADD.sh 		-o CSV/cadd.tsv.gz 		-a 		-g GRCh37 		-v v1.6 VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz
Submitted job 26 with external jobid 'Your job 4090710 ("snakejob.scoreCADD.26.sh") has been submitted'.
[Sun Aug 23 18:57:36 2020]
Finished job 24.
7 of 17 steps (41%) done

[Sun Aug 23 18:57:36 2020]
rule annotANNOVAR:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz.tbi, /sandbox/users/mguillout/tools/annovar, /sandbox/users/mguillout/tools/annovar/humandb
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.avinput, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.txt
    jobid: 10
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.avinput, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.txt, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz.tbi

perl /sandbox/users/mguillout/tools/annovar/table_annovar.pl VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz  		/sandbox/users/mguillout/tools/annovar/humandb		-buildver hg19 		-out VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf 		-remove 		-protocol refGene,knownGene,cytoBand,dgvMerged,gwasCatalog,dbnsfp35a,gnomad211_exome,clinvar_20190305 		-operation gx,g,r,r,r,f,f,f 		-nastring . 		-polish 		-otherinfo 		-xref /sandbox/users/mguillout/tools/annovar/humandb/hg19_refGene.txt 		-vcfinput
Submitted job 10 with external jobid 'Your job 4090711 ("snakejob.annotANNOVAR.10.sh") has been submitted'.
Write-protecting output file CSV/gnomad_freq.tsv.
[Sun Aug 23 18:57:46 2020]
Finished job 25.
8 of 17 steps (47%) done

[Sun Aug 23 18:57:46 2020]
rule extractGNOMADVEP:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz, CSV/gnomad_freq.tsv
    output: CSV/gnomad_vep.tsv
    jobid: 12
    reason: Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz, CSV/gnomad_freq.tsv

vep-annotation-reporter  VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.vcf.gz 	Feature HGVSc HGVSp Protein_position Amino_acids Codons CLIN_SIG PUBMED 		-t CSV/gnomad_freq.tsv 		-o CSV/gnomad_vep.tsv 		
Submitted job 12 with external jobid 'Your job 4090712 ("snakejob.extractGNOMADVEP.12.sh") has been submitted'.
[Sun Aug 23 18:58:06 2020]
Finished job 12.
9 of 17 steps (53%) done
Write-protecting output file VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.
[Sun Aug 23 18:58:26 2020]
Finished job 10.
10 of 17 steps (59%) done

[Sun Aug 23 18:58:26 2020]
rule bgzip:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz
    jobid: 1
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno

bgzip -f VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf
Submitted job 1 with external jobid 'Your job 4090713 ("snakejob.bgzip.1.sh") has been submitted'.

[Sun Aug 23 18:58:26 2020]
rule annotINTERVAR:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.avinput, /sandbox/users/mguillout/tools/annovar, /sandbox/users/mguillout/tools/annovar/humandb, /sandbox/users/mguillout/tools/InterVar-master
    output: CSV/res_intervar.hg19_multianno.txt.intervar
    jobid: 11
    reason: Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.avinput

python /sandbox/users/mguillout/tools/InterVar-master/Intervar.py 		-i VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.avinput 		-o CSV/res_intervar 		--buildver hg19 		--input_type AVinput 		--database_intervar /sandbox/users/mguillout/tools/InterVar-master/intervardb 		--config=/sandbox/users/mguillout/tools/InterVar-master/config.ini 		--convert2annovar /sandbox/users/mguillout/tools/annovar/convert2annovar.pl 		--table_annovar /sandbox/users/mguillout/tools/annovar/table_annovar.pl 		--annotate_variation /sandbox/users/mguillout/tools/annovar/annotate_variation.pl 		--database_locat /sandbox/users/mguillout/tools/annovar/humandb
Submitted job 11 with external jobid 'Your job 4090714 ("snakejob.annotINTERVAR.11.sh") has been submitted'.
[Sun Aug 23 18:58:36 2020]
Finished job 1.
11 of 17 steps (65%) done

[Sun Aug 23 18:58:36 2020]
rule tabix:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz
    output: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz.tbi
    jobid: 2
    reason: Missing output files: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz.tbi; Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz
    wildcards: base=VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz

tabix -f -p vcf VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz
Submitted job 2 with external jobid 'Your job 4090715 ("snakejob.tabix.2.sh") has been submitted'.
[Sun Aug 23 18:58:46 2020]
Finished job 2.
12 of 17 steps (71%) done
[Sun Aug 23 19:00:16 2020]
Finished job 26.
13 of 17 steps (76%) done

[Sun Aug 23 19:00:16 2020]
rule gunzipCADD:
    input: CSV/cadd.tsv.gz
    output: CSV/cadd.tsv
    jobid: 13
    reason: Input files updated by another job: CSV/cadd.tsv.gz

gunzip CSV/cadd.tsv.gz ;  sed 1d CSV/cadd.tsv -i
Submitted job 13 with external jobid 'Your job 4090716 ("snakejob.gunzipCADD.13.sh") has been submitted'.
[Sun Aug 23 19:00:36 2020]
Finished job 13.
14 of 17 steps (82%) done
[Sun Aug 23 19:12:47 2020]
Finished job 11.
15 of 17 steps (88%) done

[Sun Aug 23 19:12:47 2020]
rule merge_fields:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.txt, CSV/res_intervar.hg19_multianno.txt.intervar, CSV/gnomad_vep.tsv, CSV/cadd.tsv
    output: CSV/main_results.tsv
    jobid: 3
    reason: Missing output files: CSV/main_results.tsv; Input files updated by another job: CSV/cadd.tsv, CSV/gnomad_vep.tsv, CSV/res_intervar.hg19_multianno.txt.intervar, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.txt

Submitted job 3 with external jobid 'Your job 4090725 ("snakejob.merge_fields.3.sh") has been submitted'.
[Sun Aug 23 19:13:17 2020]
Finished job 3.
16 of 17 steps (94%) done

[Sun Aug 23 19:13:17 2020]
localrule target:
    input: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz.tbi, CSV/main_results.tsv, Samples/Sample1/QC/Sample1.gatk_doc.autosomes.sample_cumulative_coverage_counts, Samples/Sample1/QC/Sample1.gatk_doc.autosomes.sample_cumulative_coverage_proportions, Samples/Sample1/QC/Sample1.gatk_doc.autosomes.sample_statistics, Samples/Sample1/QC/Sample1.gatk_doc.autosomes.sample_summary, Samples/Sample1/QC/Sample1.gatk_doc.chrX.sample_cumulative_coverage_counts, Samples/Sample1/QC/Sample1.gatk_doc.chrX.sample_cumulative_coverage_proportions, Samples/Sample1/QC/Sample1.gatk_doc.chrX.sample_statistics, Samples/Sample1/QC/Sample1.gatk_doc.chrX.sample_summary, Samples/Sample1/QC/Sample1.gatk_doc.chrY.sample_cumulative_coverage_counts, Samples/Sample1/QC/Sample1.gatk_doc.chrY.sample_cumulative_coverage_proportions, Samples/Sample1/QC/Sample1.gatk_doc.chrY.sample_statistics, Samples/Sample1/QC/Sample1.gatk_doc.chrY.sample_summary, Samples/Sample1/QC/Sample1.picard_metrics.alignment_summary_metrics, Samples/Sample1/QC/Sample1.picard_metrics.base_distribution_by_cycle_metrics, Samples/Sample1/QC/Sample1.picard_metrics.base_distribution_by_cycle.pdf, Samples/Sample1/QC/Sample1.picard_metrics.insert_size_histogram.pdf, Samples/Sample1/QC/Sample1.picard_metrics.insert_size_metrics, Samples/Sample1/QC/Sample1.picard_metrics.quality_by_cycle_metrics, Samples/Sample1/QC/Sample1.picard_metrics.quality_by_cycle.pdf, Samples/Sample1/QC/Sample1.picard_metrics.quality_distribution_metrics, Samples/Sample1/QC/Sample1.picard_metrics.quality_distribution.pdf, Samples/Sample1/QC/Sample1.fastqc.forward_fastqc.zip, Samples/Sample1/QC/Sample1.fastqc.reverse_fastqc.zip
    jobid: 0
    reason: Input files updated by another job: VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz, CSV/main_results.tsv, VCF/hapcaller.recal.combined.annot.gnomad.vep.filtered.annovar.vcf.hg19_multianno.vcf.gz.tbi

[Sun Aug 23 19:13:17 2020]
Finished job 0.
17 of 17 steps (100%) done
Complete log: /sandbox/shares/nextcloud/mguillout/files/Application/pipeline/.snakemake/log/2020-08-23T184414.103081.snakemake.log
